<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Flappy Pig</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #fce4ec;
    font-family: 'Comic Sans MS', cursive, sans-serif;
  }
  canvas {
    display: block;
  }
  #ui {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    text-align: center;
    color: #ff69b4;
    font-size: 20px;
  }
  #leaderboard {
    margin-top: 10px;
  }
  #startScreen, #gameOverScreen {
    position: absolute;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(255,255,255,0.8);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  button {
    background: #ff69b4;
    color: white;
    padding: 10px 20px;
    font-size: 18px;
    border: none;
    border-radius: 20px;
    cursor: pointer;
  }
  #loiseTag {
    position: absolute;
    bottom: 10px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 16px;
    color: pink;
  }
  #heartButton {
    position: absolute;
    bottom: 50px;
    right: 20px;
    background: pink;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    border: none;
    font-size: 30px;
    color: white;
    cursor: pointer;
  }
</style>
</head>
<body>
<div id="ui"></div>
<div id="startScreen">
  <h1 style="color:#ff69b4;">üê∑ Flappy Pig üê∑</h1>
  <input id="playerName" placeholder="Enter your name" style="padding:5px; font-size:16px;">
  <button onclick="startGame()">Start Game</button>
  <div id="leaderboard"></div>
</div>
<div id="gameOverScreen" style="display:none;">
  <h2 style="color:#ff69b4;">Game Over!</h2>
  <button onclick="startGame()">Retry</button>
  <div id="leaderboard"></div>
</div>
<div id="loiseTag">loise cute :P</div>
<button id="heartButton" onclick="flap()">‚ù§Ô∏è</button>
<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let pig, pipes, clouds, sparkles, score, gravity, gameOver, started, playerName;
let pipeGap = 200, pipeWidth = 80, pigSize = 40;
let leaderData = JSON.parse(localStorage.getItem("leaderboard") || "[]");

function drawPig(x, y) {
  ctx.fillStyle = "#ffc0cb";
  ctx.beginPath();
  ctx.arc(x, y, pigSize/2, 0, Math.PI*2);
  ctx.fill();
  ctx.fillStyle = "#ff69b4";
  ctx.beginPath();
  ctx.arc(x+8, y-10, 5, 0, Math.PI*2); // ear
  ctx.fill();
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.ellipse(x+15, y, 15, 8, 0, 0, Math.PI*2); // wing
  ctx.fill();
}

function drawPipe(pipe) {
  ctx.fillStyle = "#00cc66";
  ctx.fillRect(pipe.x, 0, pipeWidth, pipe.top);
  ctx.fillRect(pipe.x, pipe.bottom, pipeWidth, canvas.height - pipe.bottom);
}

function drawCloud(cloud) {
  ctx.fillStyle = "white";
  ctx.beginPath();
  ctx.arc(cloud.x, cloud.y, 20, 0, Math.PI*2);
  ctx.arc(cloud.x+30, cloud.y+10, 25, 0, Math.PI*2);
  ctx.arc(cloud.x-30, cloud.y+10, 25, 0, Math.PI*2);
  ctx.fill();
}

function drawSparkle(s) {
  ctx.fillStyle = "yellow";
  ctx.beginPath();
  ctx.arc(s.x, s.y, 2, 0, Math.PI*2);
  ctx.fill();
}

function resetGame() {
  pig = {x: canvas.width/4, y: canvas.height/2, velocity: 0};
  gravity = 0.4;
  pipes = [];
  clouds = [];
  sparkles = [];
  score = 0;
  gameOver = false;
  started = true;
  for (let i=0; i<5; i++) {
    clouds.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height/2});
    sparkles.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height});
  }
}

function flap() {
  if (!gameOver && started) pig.velocity = -7;
}

function startGame() {
  playerName = document.getElementById("playerName").value || "Anonymous";
  document.getElementById("startScreen").style.display = "none";
  document.getElementById("gameOverScreen").style.display = "none";
  resetGame();
}

function update() {
  if (!started) return;
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // background sparkles
  sparkles.forEach(s => {
    drawSparkle(s);
    s.y += 1;
    if (s.y > canvas.height) { s.y = 0; s.x = Math.random()*canvas.width; }
  });

  // clouds
  clouds.forEach(c => {
    drawCloud(c);
    c.x -= 1;
    if (c.x < -50) { c.x = canvas.width + 50; c.y = Math.random()*canvas.height/2; }
  });

  // pipes
  if (Math.random() < 0.02) {
    let top = Math.random()*(canvas.height - pipeGap - 100) + 50;
    pipes.push({x: canvas.width, top: top, bottom: top + pipeGap});
  }
  pipes.forEach(p => {
    p.x -= 3;
    drawPipe(p);
  });
  pipes = pipes.filter(p => p.x + pipeWidth > 0);

  // pig physics
  pig.velocity += gravity;
  pig.y += pig.velocity;
  drawPig(pig.x, pig.y);

  // collision
  for (let p of pipes) {
    if (pig.x + pigSize/2 > p.x && pig.x - pigSize/2 < p.x + pipeWidth &&
       (pig.y - pigSize/2 < p.top || pig.y + pigSize/2 > p.bottom)) {
      endGame();
    }
    if (p.x + pipeWidth === pig.x) score++;
  }

  if (pig.y > canvas.height || pig.y < 0) endGame();

  // score display
  ctx.fillStyle = "#ff69b4";
  ctx.font = "30px Comic Sans MS";
  ctx.fillText(score, canvas.width/2, 50);

  requestAnimationFrame(update);
}

function endGame() {
  gameOver = true;
  started = false;
  leaderData.push({name: playerName, score: score});
  leaderData.sort((a,b)=>b.score-a.score);
  leaderData = leaderData.slice(0,5);
  localStorage.setItem("leaderboard", JSON.stringify(leaderData));
  showLeaderboard();
  document.getElementById("gameOverScreen").style.display = "flex";
}

function showLeaderboard() {
  let lbHTML = "<h3>Leaderboard</h3><ol>";
  leaderData.forEach(e => { lbHTML += `<li>${e.name}: ${e.score}</li>`; });
  lbHTML += "</ol>";
  document.querySelectorAll("#leaderboard").forEach(div => div.innerHTML = lbHTML);
}

showLeaderboard();
update();

window.addEventListener("keydown", e => { if (e.code === "Space") flap(); });
</script>
</body>
</html>
